<!DOCTYPE>
<html>
  <head>
    <title> Donut HQ </title>
  </head>
  <body>
    <header>
      <h1>WELCOME TO DONUT HQ!<h1>
    </header>
    <main>
      <section id="storeData">
        <input id="storeName" placeholder="Store Name" />
        <input id="hoursOpen" placeholder="Hours Open" />
        <input id="minFootTraffic" placeholder="Minimum Passersby" />
        <input id="maxFootTraffic" placeholder="Maximum Passersby" />
        <input id="percentOfPeopleEntered" placeholder="% of People Entering" />
        <input id="averageNumberDonutsBought" placeholder="Average Purchase" />
        <button id="addStore" onclick="addStoreClicked()"> Add Store! </button>
      </section>
      <section id="storeList">
        <h2>List of stores</h2>
      </section>
      <section id="storeResults">
        <button id="getResults" onclick="getResultsClicked()"> Get Results </button>
      </section>
    </main>
  </body>

  <script>
    var storeList = [],
        donutCorp;

    function DonutShop(location, numberOfHoursOpen, hourlyFootTraffic, percentEntering, donutsOrderedPerEntrant)  {
      this.location                = location;
      this.numberOfHoursOpen       = numberOfHoursOpen;
      this.hourlyFootTraffic       = hourlyFootTraffic;  //array containing min and max range
      this.percentEntering         = percentEntering;
      this.donutsOrderedPerEntrant = donutsOrderedPerEntrant;

      this.customersPerHour = function() {
        return(Math.ceil(Math.random() * (this.hourlyFootTraffic[1] - this.hourlyFootTraffic[0]) + this.hourlyFootTraffic[0]));
      };
      this.donutsSoldPerHour = function() {
        return(this.customersPerHour() * this.percentEntering * this.donutsOrderedPerEntrant);
      };
      this.donutsSoldPerDay = function() {
        var donutsSold = 0;
        for (var i=0; i<this.numberOfHoursOpen; i++)  {
          donutsSold += this.donutsSoldPerHour();
        }
        return (Math.floor(donutsSold));
      };
    };

    function DonutCorporation(storeList) {
      this.storeList = storeList;
      this.generateSalesInfo = function() {   //returns a jagged(?) 2-D array with list of store names and donuts sold per store that day
        document.getElementById('storeResults').innerHTML += "<br>Generating Sales Information for today....<br>";
        var salesReport = [];
        for(var i=0; i<this.storeList.length; i++) {
          var storeNameAndSales = [];
          storeNameAndSales[0] = this.storeList[i].location;
          storeNameAndSales[1] = this.storeList[i].donutsSoldPerDay();
          salesReport[i] = storeNameAndSales;
        }
        return salesReport;
      };
      this.listAndGraphSalesByStore = function() {  //lists total sales per store and makes a cheesy
                                                    //donut ( 'O' ) graph for each one
        var dailySales = this.generateSalesInfo();
        for (var i=0; i<dailySales.length; i++) {
          document.getElementById('storeResults').innerHTML +="<br>";   // For an extra line of spacing for output formatting.
          document.getElementById('storeResults').innerHTML +="Donuts sold by " + dailySales[i][0] + ": " + dailySales[i][1];
          var graph = "<br>";
          for(var j=0; j<dailySales[i][1]; j++) {
            graph += "O";
            if(j>0 && j%100 == 0) {
              graph += "<br>";
            }
          }
          document.getElementById('storeResults').innerHTML += graph;
        }
      };
    };

    function addStoreClicked() {
      var footTrafficRange = [document.getElementById('minFootTraffic').value,
                              document.getElementById('maxFootTraffic').value];
      //create new store
      storeList.push(new DonutShop(document.getElementById('storeName').value,
                                   document.getElementById('hoursOpen').value,
                                   footTrafficRange,
                                   document.getElementById('percentOfPeopleEntered').value/100,
                                   document.getElementById('averageNumberDonutsBought').value));
     //add store name to visible list of stores
      document.getElementById('storeList').innerHTML += document.getElementById('storeName').value + "<br>";
      //clear text boxes
      document.getElementById('storeName').value = "";
      document.getElementById('hoursOpen').value = "";
      document.getElementById('minFootTraffic').value = "";
      document.getElementById('maxFootTraffic').value = "";
      document.getElementById('percentOfPeopleEntered').value = "";
      document.getElementById('averageNumberDonutsBought').value = "";
    }
    function getResultsClicked() {
      var donutCorp = new DonutCorporation(storeList);
      donutCorp.listAndGraphSalesByStore();
    }
  </script>
</html>
